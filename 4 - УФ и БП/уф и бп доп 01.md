# Билет 1 (дополнительный)

Необходимо создать управляемую основную форму в справочнике «Физические лица».

![image](/4%20-%20УФ%20и%20БП/media/ticket-extra-1-1.png)


При нажатии на гиперссылку «Показать личные данные» должны отображаться дополнительные поля формы, при этом заголовок раздела также должен измениться.

![image](/4%20-%20УФ%20и%20БП/media/ticket-extra-1-2.png)

На закладке «Контактная информация» должны отображаться контактные данные физического лица.

![image](/4%20-%20УФ%20и%20БП/media/ticket-extra-1-3.png)

На закладке «Начисление зарплаты» должны быть выведен список документов «Начисление зарплаты», в табличной части которых присутствует данное физическое лицо.

![image](/4%20-%20УФ%20и%20БП/media/ticket-extra-1-4.png)


## Предварительная подготовка

### Пол

Добавляем перечисление для хранения пола физ. лиц.

### Виды контактной иформации

Добавляем перечисление/справочник для хранения контактной информации о физ. лицах.

### Физические лица

Добавляем:
- Реквизиты:
	- Фамилия
	- Имя
	- Отчетство
	- Дата рождения
	- Пол и пр.
- Табличные части:
	- Контактная информация
		- Вид контактной информации
		- Значение


## Форма справочника

Создаем форму элемента.

Добавляем:
- ГруппаСтраницы (страницы - именно множественное число)
	- ГруппаГлавная (страница - именно единственное число)
	- ГруппаКонтактнаяИнформация (страница)
	- ГруппаНачисленияЗарплаты (страница)

Дополнительно понадобятся реквизиты формы:
- ПоказатьЛичнуюИнформацию (булево)
- НачисленияЗарплаты (динамический список)

### Главная

Переносим реквизиты, разносим по группам.

Для отображения личной информации:

1. Создаем `надпись` на форме

2. Устанавливаем видимость элементов

	Создаем метод, который устанавливаем видимость в зависимости от значения `ПоказатьЛичныеДанные`
	```1c
	&НаСервере
	Процедура УстановитьВидимостьДоступность()	
		// группы желательно тоже скрывать, но не обязательно
		Элементы.ГруппаЛичнаяИнформация.Видимость = ПоказатьЛичныеДанные;
		Элементы.ГруппаБио.Видимость = ПоказатьЛичныеДанные;
		Элементы.ГруппаДополнительныеСвежения.Видимость = ПоказатьЛичныеДанные;
		// скрываем или показываем реквизиты
		Элементы.ДатаРождения.Видимость = ПоказатьЛичныеДанные;
		Элементы.Пол.Видимость = ПоказатьЛичныеДанные;
		Элементы.СтраховойНомер.Видимость = ПоказатьЛичныеДанные;
	КонецПроцедуры
	```

3. Устанавливаем обработку нажатия для надписи
	```1c
	&НаКлиенте
	Процедура ЛичныеДанныеНажатие(Элемент)
		// при нажатии меняем значение на противоположное
		ПоказатьЛичныеДанные = НЕ ПоказатьЛичныеДанные;
		// устанавливаем заголовок
		ЗаголовокНадписи = ?(ПоказатьЛичныеДанные, "Личные данные", "Показать личные данные");
		Элементы.ЛичныеДанные.Заголовок = ЗаголовокНадписи;
		
		// обновляем отображение
		УстановитьВидимостьДоступность();
	КонецПроцедуры
	```

### Контактная информация

Выносим табличную часть в соответсвующую группу


### Начисления зарплаты

Для реквизита формы `НачисленияЗарплаты` устанавливаем:
- произвольный запрос: да

Редактируем текст запроса
```1c
ВЫБРАТЬ
	// важно брать по ссылке, а не
	// НачислениеЗарплаты.Дата 
	// почему-то обращение напрямую к дате и номеру вызывает ошибки
	НачислениеЗарплаты.Ссылка.Дата КАК Дата,
	НачислениеЗарплаты.Ссылка.Номер КАК Номер
ИЗ
	Документ.НачислениеЗарплаты КАК НачислениеЗарплаты
ГДЕ
	(НачислениеЗарплаты.ОсновныеНачисления.Сотрудник = &Сотрудник
			ИЛИ НачислениеЗарплаты.ДополнительныеНачисления.Сотрудник = &Сотрудник)
```

Устанавливаем основной таблицей `Документ.НачисленияЗарплаты`.


Переносим реквизит в нужную группу. Чтобы пользователь не мог создать документы из формы физ.лица, ставим галочку `Только просмотр`
