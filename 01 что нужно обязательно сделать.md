# Что обязательно нужно сделать


## Общее

### Проверка заполнения
Устанавливать **Проверку заполнения** или аналоги для ключевых реквизитов и табличных частей/измерений


### Алгоритм записи движений

Установка флагов на запись движений:
- Для старой методики: в самом начале "Записывать = Истина" + "Записать()" + "Записывать = Истина"
- Для новой методики: "Записывать = Истина" + "Записать()" (после формирования предварительных движений)


### Блокировки 

- Для старой методики: с помощью блокировки данных, **до запроса**
- Для новой: с помощью `БлокироватьДляИзменения`, после предварительной записи в регистр, **до контроля отрицательных остатков**

### На какую дату брать данные из регистров при списании
- Для старой методики: `МоментВремени()`
- Для новой: формирование движение - "Дата", контроль остатков - `Новый Граница(МоментВремени(), ВидГраницы.Включая)`

### Индексация таблиц

Для полей левого соединения или полей типа `Номенклатура В (Выбрать Т.Номенклатура из втТЧТовары КАК Т))`

### Представление номенклатуры

Чтобы не словить ошибку `Запрос в цикле` в случае вроде:
```1c
Пока Выборка.Следующий() Цикл
	Сообщить(Выборка.Номенклатура.Наименование);
	// аналогично Сообщить(Выборка.Номенклатура);
	// т.к. выполняется неявный вызов представления номенклатуры
КонецЦикла;
```

При выполнении **запроса** получаем `Номенклатура.Представление` и выводим его
```1c
Пока Выборка.Следующий() Цикл
	Сообщить(Выборка.НоменклатураПредставление);
КонецЦикла;
```
### Проблема копеек

Проблема копеек: проверяем на полное/последнее списание

### Особенности работы с левым соединением

- ЕСТЬNULL() для левых и полных соединений для числовых значений (т.к. с ними будут арифметические операции)
- Если делать левое соединение, и по правой таблице делать отбор, то соединение становится внутренним (леонтьев, занятие 23, примерно 12 минута). 
	- Чтобы соединение осталось левым, надо прописать отбор в условии соединения
	- Иногда условие в объединении не приносит результата, нужно делать временные таблицы и соединяться по ним


## ОУ


### Использование старой методики для расчета себестоимости

Себестоимость и распределение денег по какому-либо порядку (фифо/лифо, по партиям, проектам и пр.) считается по `старой методике`. 

### Использование новой методики для расчета себестоимости

Просто списания (отдельно от расчета себестоимости/распредения) можно расчитывать по `новой методике`.

### Создание отдельного регистра для отчета продаж

Условия, по которым нужно делать выбор в пользу `отдельного оборотного регистра` для отчета по продажам:
- остатки ведутся в одном разрезе (например, партия), а отчет по продажам явно не использует такие же разрезы (не использует партию)
- в отчете не нужны начальный и конечный остатки
- остатки номенклатуры не содержит данных по услугам, а в отчете по продажам услуги есть



## БУ

### Настройка планов счетов Управленческий

-План счетов "Управленческий" (в каркасной конфигурации уже есть)
- На вкладке "Субконто" указать "Виды субконто" - план видов характеристик "ВидыСубконто" (в каркасной конфигурации уже есть)
- Указываем максимальное количество субконто (по необходимости, но больше 3 максимальное не рекомендуется)
- Признаки учета (флажок для всего счета). Связывается в ресурсами регистра бухгалтерии через "Параметры субконто"
- Признаки учета субконто (флажок для субконто)
 
 ### Заполнение регистра бухгалтерии

Заполняем [по инструкции](/05%20как%20заполнить%20регистр%20бухгалтерии.md)

### Документ Операция

Заполняем [по инструкции](/04%20как%20создать%20документ%20Операция%20или%20ее%20аналоги.md)

### Работа с блокировками и запросами

- В блокировках обязательно указывать `счет`
- В запросах обязательно указывать `виды субконто`, если два соединения с регистром бухгалтерии - `2 разных массива субконто`
- В запросах в отчетах `по оборотам` - дополнительно `корреспондирующие счета`
- При обращении к субконто через точку (или в отчете СКД) выражать субконто к конкретному типу


## СПР

### Заполнение регистров расчета

Заполняем [по инструкции](/06%20как%20заполнить%20планы%20и%20регистры%20расчета.md)

### Обработка Графики работы

В ней есть 2 цикла, убираем первый (он изменяет существующие записи). 

Без певрого цикла будет легче исправлять обработку для условий, которые указаны в задаче (график работы, дни и пр.).

### Базовые измерения

Измерения выставлять как базовые, если они используются для получения базы (т.е. на основе чего считается премия, больничный и пр.) 

### Ошибки и их исправление

1. Необходим пересчет фактического периода действия: такое возникает, если перезаписываются измерения

